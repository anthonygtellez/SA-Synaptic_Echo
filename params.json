{"name":"Synaptic Echo","tagline":"This Supporting Add-On Parses PDF indicators of compromise (IOCs), keeps a repository of the PDF's uploaded and runs scheduled searches against IOCs.","body":"## SA-Synaptic_Echo\r\nThis Supporting Add-On Parses PDF indicators of compromise (IOCs), keeps a repository of the PDF's uploaded and runs scheduled searches against IOCs.</br>\r\n</br>\r\nSA-Synaptic_Echo ships with the APTnotes PDFs by defualt. The PDFs are located in `SA-Synaptic_Echo/bin/APTnotes` and organized by year. They have already been parsed and appear in the csv lookupfile: `indicatorsofcompromise.csv`</br>\r\nYou can learn more about this project or contribute: https://github.com/kbandla/APTnotes</br>\r\n</br>\r\n###System Requirements:\r\nThis SA requires the user to be running Python 2.7</br>\r\nThis SA has only been tested for Linux & Mac OS</br>\r\nSA Requires PIP to install the pdf parsing libary</br>\r\n</br>\r\n###Installation Instructions:\r\nInstall the .tar.gz file using the splunk command line, via the GUI or untar the tarball into `$SPLUNK_HOME$/etc/apps`</br>\r\n####Use command line install PIP</br>\r\nOn Debian and Ubuntu:\r\n\r\n`$ sudo apt-get install python-pip`\r\n\r\nOn Fedora:\r\n\r\n`$ sudo yum install python-pip`\r\n\r\nUse PIP to install the pdf parsing libarary:</br>\r\n`$ pip install pdfminer`\r\n\r\ncd to: `$SPLUNK_HOME$/etc/apps/SA-Synaptic_Echo/bin`</br>\r\nrun the following command:</br>\r\n`$ python iocp.py /path/to/pdffile`</br>\r\n\r\nRunning this will append the IOC indicators into the lookup file `indicatorsofcompromise.csv`\r\n\r\n###Usage:\r\n</br>\r\nI have also included a few extra utilities which allow you to do a mass importation of pdfs:</br>\r\n\r\n`$SPLUNK_HOME$/SA-Synaptic_Echo/bin/removespaces.sh`</br>\r\n</br>\r\nThis bash script will rename the PDFs to a friendly format eg. `fireeye ioc report.pdf -> fireeye_ioc_report.pdf`</br>\r\nThis step is required in order to prevent the script from treaing white space as seperate items.\r\nUsage:</br>\r\nCreate a folder/directory to store the pdfs to mass import:</br>\r\n`$ mkdir fireye_reports`</br>\r\n\r\ncd into the directory where the pdf files are`eg. $ cd fireeye_reports`</br>\r\n`$ pwd `</br>\r\n`/saved_data/ioc_reports/fireeye_reports`</br>\r\n\r\nexecute the script, it will only rename files in your current directory.</br>\r\n`$ bash removespaces.sh`</br>\r\n\r\nNow that you have a friendly name for your pdf files you need to build a list for the mass import script:</br>\r\n`$SPLUNK_HOME$/SA-Synaptic_Echo/bin/massimport.sh`</br>\r\n\r\nUse the commandline to output all of the path/to/pdffiles</br>\r\nFrom `$SPLUNK_HOME$/SA-Synaptic_Echo/bin/`</br>\r\n`$ ls /saved_data/ioc_reports/*_reports/*.pdf > all_ioc_reports.txt`</br>\r\n\r\nOnce this step is complete, you will have a textfile list that looks like:</br>\r\n`/saved_data/ioc_reports/fireeye_reports/fireeye_ioc_report.pdf`</br>\r\n`/saved_data/ioc_reports/isight_reports/isight_ioc_report.pdf`</br>\r\n`/saved_data/ioc_reports/clownstrike_reports/threatbutt_ioc_report.pdf`</br>\r\n</br>\r\nThis file will be used for the mass import.</br>\r\nThis final step may take some time depending on the number of IOCs detected and the number of PDFs you are parsing.</br>\r\n`$ bash massimport.sh all_ioc_reports.txt`</br>\r\n\r\n###Splunk Configuration:\r\n\r\n###Legal\r\nSplunk is a registered trademark of Splunk, Inc.</br>\r\nSynaptic Echoâ„¢ is a trademark of Anthony Tellez\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}